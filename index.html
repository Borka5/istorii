<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–°–∞–π—Ç —Å –∏—Å—Ç–æ—Ä–∏—è–º–∏</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f0f0f0;
        }
        .story-container {
            background-color: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .story-title {
            color: #333;
            font-size: 24px;
            margin-bottom: 10px;
        }
        .story-text {
            line-height: 1.6;
            color: #444;
        }
        .nav-menu {
            background-color: #333;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .nav-menu ul {
            list-style: none;
            padding: 0;
            margin: 0;
            display: flex;
            gap: 20px;
        }
        .nav-menu a {
            color: white;
            text-decoration: none;
            font-size: 18px;
            transition: color 0.3s;
        }
        .nav-menu a:hover {
            color: #ffd700;
        }
        .story-form {
            background-color: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .story-form h2 {
            color: #333;
            margin-bottom: 20px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #444;
        }
        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        .form-group textarea {
            height: 200px;
            resize: vertical;
        }
        .submit-button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        .submit-button:hover {
            background-color: #45a049;
        }
        .story-author {
            color: #666;
            font-style: italic;
            margin-bottom: 10px;
        }
        
        .story-actions {
            margin-top: 15px;
            display: flex;
            gap: 10px;
        }
        
        .like-button, .share-button {
            padding: 5px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .like-button.liked {
            background-color: #ff3333;
            opacity: 0.8;
        }
        
        .like-button[disabled] {
            background-color: #ccc;
            cursor: not-allowed;
            opacity: 0.7;
        }
        
        .like-button:hover:not([disabled]) {
            background-color: #ff3333;
        }
        
        .share-button {
            background-color: #4d79ff;
            color: white;
        }
        
        .share-button:hover {
            background-color: #3366ff;
        }
        
        .stories-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        .message {
            padding: 10px 20px;
            border-radius: 4px;
            margin: 10px 0;
            display: none;
        }
        
        .success-message {
            background-color: #dff0d8;
            color: #3c763d;
            border: 1px solid #d6e9c6;
        }
        
        .error-message {
            background-color: #f2dede;
            color: #a94442;
            border: 1px solid #ebccd1;
        }
        
        .form-group .error {
            color: #a94442;
            font-size: 14px;
            margin-top: 5px;
            display: none;
        }
        .search-container {
            margin: 20px 0;
            position: relative;
        }
        
        #searchInput {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            transition: border-color 0.3s, box-shadow 0.3s;
        }
        
        #searchInput:focus {
            border-color: #4CAF50;
            box-shadow: 0 2px 8px rgba(76,175,80,0.2);
            outline: none;
        }
        
        .search-icon {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #666;
        }
        
        .story-container.hidden {
            display: none;
        }
        
        .no-results {
            text-align: center;
            padding: 20px;
            color: #666;
            font-style: italic;
            display: none;
        }
        .auth-container {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin: 20px 0;
            display: none;
        }
        
        .auth-container.active {
            display: block;
        }
        
        .auth-buttons {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .auth-info {
            display: none;
            align-items: center;
            gap: 10px;
        }
        
        .auth-info.active {
            display: flex;
        }
        
        .logout-button {
            background-color: #ff4444;
            color: white;
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .user-name {
            font-weight: bold;
            color: #333;
        }
        
        #myStoriesBtn {
            background-color: #4CAF50;
            color: white;
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        #myStoriesBtn:hover {
            background-color: #45a049;
        }
        
        .nav-menu button.active {
            background-color: #45a049;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .no-stories-message {
            text-align: center;
            padding: 20px;
            color: #666;
            font-style: italic;
        }
        .password-container {
            position: relative;
            display: flex;
            align-items: center;
        }

        .toggle-password {
            position: absolute;
            right: 10px;
            background: none;
            border: none;
            cursor: pointer;
            padding: 0;
            font-size: 16px;
            color: #666;
        }

        .toggle-password:hover {
            color: #333;
        }

        .password-container input {
            width: 100%;
            padding-right: 35px;
        }

        #likedStoriesBtn {
            background-color: #4CAF50;
            color: white;
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        #likedStoriesBtn:hover {
            background-color: #45a049;
        }
        
        #likedStoriesBtn.active {
            background-color: #45a049;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <nav class="nav-menu">
        <ul>
            <li><button id="myStoriesBtn" onclick="showMyStories()" style="display: none;">–ú–æ–∏ –∏—Å—Ç–æ—Ä–∏–∏</button></li>
            <li><button id="likedStoriesBtn" onclick="showLikedStories()" style="display: none;">–ü–æ–Ω—Ä–∞–≤–∏–≤—à–∏–µ—Å—è</button></li>
            <li class="auth-buttons" id="authButtons">
                <button onclick="showAuthForm('login')">–í–æ–π—Ç–∏</button>
                <button onclick="showAuthForm('register')">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
            </li>
            <li class="auth-info" id="authInfo">
                <span class="user-name" id="userName"></span>
                <button class="logout-button" onclick="logout()">–í—ã–π—Ç–∏</button>
            </li>
        </ul>
    </nav>
    
    <h1>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –º–∏—Ä –∏—Å—Ç–æ—Ä–∏–π</h1>
    
    <div class="search-container">
        <input type="text" id="searchInput" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é, –∞–≤—Ç–æ—Ä—É –∏–ª–∏ —Ç–µ–∫—Å—Ç—É –∏—Å—Ç–æ—Ä–∏–∏...">
        <span class="search-icon">üîç</span>
    </div>
    
    <div id="noResults" class="no-results">
        –ò—Å—Ç–æ—Ä–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã
    </div>

    <!-- –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∏—Å—Ç–æ—Ä–∏–π -->
    <div class="stories-container">
        <!-- –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ -->
        <div class="story-container">
            <h2 class="story-title">–ò—Å—Ç–æ—Ä–∏—è 1</h2>
            <div class="story-text">
                –í –æ–¥–∏–Ω –ø—Ä–µ–∫—Ä–∞—Å–Ω—ã–π –¥–µ–Ω—å –≤ –º–∞–ª–µ–Ω—å–∫–æ–º –≥–æ—Ä–æ–¥–∫–µ —Å–ª—É—á–∏–ª–æ—Å—å –Ω–µ—á—Ç–æ –Ω–µ–æ–±—ã—á–Ω–æ–µ. 
                –í—Å–µ –∂–∏—Ç–µ–ª–∏ –ø—Ä–æ—Å–Ω—É–ª–∏—Å—å –∏ –æ–±–Ω–∞—Ä—É–∂–∏–ª–∏, —á—Ç–æ –∏—Ö –¥–æ–º–∞ –æ–∫—Ä–∞—Å–∏–ª–∏—Å—å –≤ —Ä–∞–∑–Ω—ã–µ —Ü–≤–µ—Ç–∞ —Ä–∞–¥—É–≥–∏. 
                –ù–∏–∫—Ç–æ –Ω–µ –∑–Ω–∞–ª, –∫–∞–∫ —ç—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ, –Ω–æ —ç—Ç–æ—Ç –¥–µ–Ω—å –Ω–∞–≤—Å–µ–≥–¥–∞ –∏–∑–º–µ–Ω–∏–ª –∂–∏–∑–Ω—å –≥–æ—Ä–æ–∂–∞–Ω...
            </div>
        </div>

        <div class="story-container">
            <h2 class="story-title">–ò—Å—Ç–æ—Ä–∏—è 2</h2>
            <div class="story-text">
                –ù–∞ –æ–∫—Ä–∞–∏–Ω–µ –ª–µ—Å–∞ –∂–∏–ª —Å—Ç–∞—Ä—ã–π –º—É–¥—Ä–µ—Ü, –∫–æ—Ç–æ—Ä—ã–π –∑–Ω–∞–ª —è–∑—ã–∫ –∂–∏–≤–æ—Ç–Ω—ã—Ö. 
                –ö–∞–∂–¥–æ–µ —É—Ç—Ä–æ –∫ –Ω–µ–º—É –ø—Ä–∏—Ö–æ–¥–∏–ª–∏ –ª–µ—Å–Ω—ã–µ –∂–∏—Ç–µ–ª–∏ –∏ —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–ª–∏ —Å–≤–æ–∏ –∏—Å—Ç–æ—Ä–∏–∏. 
                –û–¥–Ω–∞–∂–¥—ã –ø—Ä–æ–∏–∑–æ—à–ª–æ —á—Ç–æ-—Ç–æ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ —É–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ–µ...
            </div>
        </div>
    </div>

    <div class="story-form">
        <h2>–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –∏—Å—Ç–æ—Ä–∏—é</h2>
        <div id="successMessage" class="message success-message">–ò—Å—Ç–æ—Ä–∏—è —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∞!</div>
        <div id="errorMessage" class="message error-message"></div>
        <form id="newStoryForm">
            <div class="form-group">
                <label for="storyTitle">–ù–∞–∑–≤–∞–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏:</label>
                <input type="text" id="storyTitle" name="storyTitle" required>
                <div class="error" id="titleError"></div>
            </div>
            
            <div class="form-group">
                <label for="storyText">–¢–µ–∫—Å—Ç –∏—Å—Ç–æ—Ä–∏–∏:</label>
                <textarea id="storyText" name="storyText" required></textarea>
                <div class="error" id="textError"></div>
            </div>
            
            <button type="submit" class="submit-button">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é</button>
        </form>
    </div>

    <div class="auth-container" id="authContainer">
        <h2 id="authTitle">–í—Ö–æ–¥</h2>
        <form id="authForm">
            <div class="form-group">
                <label for="username">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
                <input type="text" id="username" name="username" required>
                <div class="error" id="usernameError"></div>
            </div>
            
            <div class="form-group">
                <label for="password">–ü–∞—Ä–æ–ª—å:</label>
                <div class="password-container">
                    <input type="password" id="password" name="password" required>
                    <button type="button" class="toggle-password" onclick="togglePassword()">üëÅÔ∏è</button>
                </div>
                <div class="error" id="passwordError"></div>
            </div>
            
            <button type="submit" class="submit-button">–í–æ–π—Ç–∏</button>
        </form>
    </div>

    <script>
        function validateStory(data) {
            let isValid = true;
            const errors = {};
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ XSS
            const sanitizeInput = (input) => {
                return input.replace(/[<>]/g, '');
            };
            
            // –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞–∑–≤–∞–Ω–∏—è
            if (!data.storyTitle || data.storyTitle.trim().length < 3) {
                errors.title = '–ù–∞–∑–≤–∞–Ω–∏–µ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 3 —Å–∏–º–≤–æ–ª–∞';
                isValid = false;
            } else if (data.storyTitle.length > 100) {
                errors.title = '–ù–∞–∑–≤–∞–Ω–∏–µ –Ω–µ –¥–æ–ª–∂–Ω–æ –ø—Ä–µ–≤—ã—à–∞—Ç—å 100 —Å–∏–º–≤–æ–ª–æ–≤';
                isValid = false;
            }
            
            // –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ –∏—Å—Ç–æ—Ä–∏–∏
            if (!data.storyText || data.storyText.trim().length < 10) {
                errors.text = '–ò—Å—Ç–æ—Ä–∏—è –¥–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 10 —Å–∏–º–≤–æ–ª–æ–≤';
                isValid = false;
            } else if (data.storyText.length > 5000) {
                errors.text = '–ò—Å—Ç–æ—Ä–∏—è –Ω–µ –¥–æ–ª–∂–Ω–∞ –ø—Ä–µ–≤—ã—à–∞—Ç—å 5000 —Å–∏–º–≤–æ–ª–æ–≤';
                isValid = false;
            }
            
            // –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
            if (isValid) {
                data.storyTitle = sanitizeInput(data.storyTitle);
                data.storyText = sanitizeInput(data.storyText);
            }
            
            return { isValid, errors };
        }

        function showError(field, message) {
            try {
                const errorElement = document.getElementById(`${field}Error`);
                if (errorElement) {
                    errorElement.textContent = message;
                    errorElement.style.display = 'block';
                    
                    // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –ø–æ–ª–µ —Å –æ—à–∏–±–∫–æ–π
                    const inputElement = document.getElementById(field);
                    if (inputElement) {
                        inputElement.classList.add('error');
                        // –£–±–∏—Ä–∞–µ–º –ø–æ–¥—Å–≤–µ—Ç–∫—É —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
                        setTimeout(() => {
                            inputElement.classList.remove('error');
                        }, 3000);
                    }
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –æ—à–∏–±–∫–∏ –ø–æ–ª—è:', error);
            }
        }

        function clearErrors() {
            try {
                // –û—á–∏—â–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
                const errorElements = document.querySelectorAll('.error-message');
                errorElements.forEach(element => {
                    element.textContent = '';
                    element.style.display = 'none';
                });
                
                // –£–±–∏—Ä–∞–µ–º –ø–æ–¥—Å–≤–µ—Ç–∫—É –ø–æ–ª–µ–π —Å –æ—à–∏–±–∫–∞–º–∏
                const inputElements = document.querySelectorAll('.error');
                inputElements.forEach(element => {
                    element.classList.remove('error');
                });
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ –æ—à–∏–±–æ–∫:', error);
            }
        }

        function showMessage(type, message, duration = 3000) {
            try {
                const messageContainer = document.getElementById('messageContainer');
                if (!messageContainer) return;
                
                // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
                const messageElement = document.createElement('div');
                messageElement.className = `message ${type}-message`;
                messageElement.textContent = message;
                
                // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
                messageContainer.appendChild(messageElement);
                
                // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è
                setTimeout(() => {
                    messageElement.classList.add('show');
                }, 100);
                
                // –£–¥–∞–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è
                setTimeout(() => {
                    messageElement.classList.remove('show');
                    setTimeout(() => {
                        messageContainer.removeChild(messageElement);
                    }, 300);
                }, duration);
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–∫–∞–∑–µ —Å–æ–æ–±—â–µ–Ω–∏—è:', error);
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–µ–∂–∏–º–∞ –±—Ä–∞—É–∑–µ—Ä–∞ –∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
        function checkBrowserMode() {
            try {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å localStorage
                const test = '__storage_test__';
                localStorage.setItem(test, test);
                localStorage.removeItem(test);
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–º–µ—Ä –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
                let size = 0;
                const testData = 'x'.repeat(1024 * 1024); // 1MB –¥–∞–Ω–Ω—ã—Ö
                try {
                    for (let i = 0; size < 10; i++) {
                        localStorage.setItem(`test${i}`, testData);
                        size++;
                    }
                } catch (e) {
                    // –î–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
                } finally {
                    // –û—á–∏—â–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
                    for (let i = 0; i < size; i++) {
                        localStorage.removeItem(`test${i}`);
                    }
                }
                
                return {
                    isAvailable: true,
                    isPrivateMode: size < 5, // –ï—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ –º–µ–Ω–µ–µ 5MB, –≤–µ—Ä–æ—è—Ç–Ω–æ —ç—Ç–æ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π —Ä–µ–∂–∏–º
                    storageSize: size
                };
            } catch (e) {
                return {
                    isAvailable: false,
                    isPrivateMode: true,
                    storageSize: 0
                };
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å —É—á–µ—Ç–æ–º —Ä–µ–∂–∏–º–∞ –±—Ä–∞—É–∑–µ—Ä–∞
        function initializeWithBrowserMode() {
            const browserMode = checkBrowserMode();
            
            if (!browserMode.isAvailable) {
                showBrowserModeWarning('storage-unavailable');
                return false;
            }
            
            if (browserMode.isPrivateMode) {
                showBrowserModeWarning('private-mode');
                // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ä–∞–±–æ—Ç—É, –Ω–æ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏
                return true;
            }
            
            return true;
        }

        // –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –æ —Ä–µ–∂–∏–º–µ –±—Ä–∞—É–∑–µ—Ä–∞
        function showBrowserModeWarning(type) {
            const warningContainer = document.createElement('div');
            warningContainer.className = 'browser-mode-warning';
            
            switch (type) {
                case 'storage-unavailable':
                    warningContainer.innerHTML = `
                        <div class="warning-message">
                            <h3>‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ: –•—Ä–∞–Ω–∏–ª–∏—â–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ</h3>
                            <p>–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –¥–æ—Å—Ç—É–ø–∞ –∫ –ª–æ–∫–∞–ª—å–Ω–æ–º—É —Ö—Ä–∞–Ω–∏–ª–∏—â—É. –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:</p>
                            <ul>
                                <li>–í—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π —Ä–µ–∂–∏–º –±—Ä–∞—É–∑–µ—Ä–∞</li>
                                <li>–í –±—Ä–∞—É–∑–µ—Ä–µ –æ—Ç–∫–ª—é—á–µ–Ω–æ –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ</li>
                                <li>–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–µ—Å—Ç–∞ –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ</li>
                            </ul>
                            <p>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:</p>
                            <ul>
                                <li>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º –±—Ä–∞—É–∑–µ—Ä–∞</li>
                                <li>–û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à –∏ –¥–∞–Ω–Ω—ã–µ –±—Ä–∞—É–∑–µ—Ä–∞</li>
                                <li>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–æ–π –±—Ä–∞—É–∑–µ—Ä</li>
                            </ul>
                        </div>
                    `;
                    break;
                    
                case 'private-mode':
                    warningContainer.innerHTML = `
                        <div class="warning-message">
                            <h3>‚ÑπÔ∏è –ü—Ä–∏–≤–∞—Ç–Ω—ã–π —Ä–µ–∂–∏–º</h3>
                            <p>–í—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π —Ä–µ–∂–∏–º –±—Ä–∞—É–∑–µ—Ä–∞. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç:</p>
                            <ul>
                                <li>–î–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å —É—Ç–µ—Ä—è–Ω—ã –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –≤–∫–ª–∞–¥–∫–∏</li>
                                <li>–ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã</li>
                                <li>–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –±—É–¥–µ—Ç —Å–±—Ä–æ—à–µ–Ω–∞ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –±—Ä–∞—É–∑–µ—Ä–∞</li>
                            </ul>
                            <p>–î–ª—è –ø–æ–ª–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º.</p>
                        </div>
                    `;
                    break;
            }
            
            document.body.insertBefore(warningContainer, document.body.firstChild);
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º —Å —É—á–µ—Ç–æ–º —Ä–µ–∂–∏–º–∞ –±—Ä–∞—É–∑–µ—Ä–∞
        function safeStorage(operation, key, data = null) {
            try {
                switch (operation) {
                    case 'get':
                        const item = localStorage.getItem(key);
                        return item ? JSON.parse(item) : null;
                        
                    case 'set':
                        if (data === null) return false;
                        localStorage.setItem(key, JSON.stringify(data));
                        return true;
                        
                    case 'remove':
                        localStorage.removeItem(key);
                        return true;
                        
                    case 'clear':
                        localStorage.clear();
                        return true;
                        
                    default:
                        throw new Error('–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è —Å —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º');
                }
            } catch (error) {
                console.error(`–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º (${operation}):`, error);
                showMessage('error', '–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –¥–∞–Ω–Ω—ã–º–∏');
                return null;
            }
        }

        // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏
        function getStoriesFromLocalStorage() {
            return safeStorage('get', 'stories') || [];
        }

        function saveStoriesToLocalStorage(stories) {
            return safeStorage('set', 'stories', stories);
        }

        function getCurrentUser() {
            return safeStorage('get', 'currentUser');
        }

        function setCurrentUser(user) {
            return safeStorage('set', 'currentUser', user);
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Ä–µ–∂–∏–º–∞ –±—Ä–∞—É–∑–µ—Ä–∞
        document.addEventListener('DOMContentLoaded', () => {
            if (initializeWithBrowserMode()) {
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
                initializeAppData();
                setupEventListeners();
                updateAuthUI();
                displayStories();
            }
        });

        // –§—É–Ω–∫—Ü–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        function initializeAppData() {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –∏—Å—Ç–æ—Ä–∏–π
            if (!localStorage.getItem('stories')) {
                localStorage.setItem('stories', JSON.stringify([]));
            }
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            if (!localStorage.getItem('users')) {
                localStorage.setItem('users', JSON.stringify([]));
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const currentUser = getCurrentUser();
            if (currentUser) {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                const users = getUsers();
                if (!users.some(u => u.username === currentUser.username)) {
                    localStorage.removeItem('currentUser');
                }
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
        function setupEventListeners() {
            // –§–æ—Ä–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
            const authForm = document.getElementById('authForm');
            if (authForm) {
                authForm.addEventListener('submit', handleAuthSubmit);
            }
            
            // –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏
            const storyForm = document.getElementById('newStoryForm');
            if (storyForm) {
                storyForm.addEventListener('submit', handleStorySubmit);
            }
            
            // –ü–æ–∏—Å–∫ –∏—Å—Ç–æ—Ä–∏–π
            const searchInput = document.getElementById('searchInput');
            if (searchInput) {
                searchInput.addEventListener('input', debounce((e) => {
                    searchStories(e.target.value);
                }, 300));
                
                // –û—á–∏—Å—Ç–∫–∞ –ø–æ–∏—Å–∫–∞ –ø–æ Escape
                searchInput.addEventListener('keyup', (e) => {
                    if (e.key === 'Escape') {
                        searchInput.value = '';
                        searchStories('');
                    }
                });
            }
            
            // –ö–Ω–æ–ø–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            const myStoriesBtn = document.getElementById('myStoriesBtn');
            if (myStoriesBtn) {
                myStoriesBtn.addEventListener('click', showMyStories);
            }
            
            const likedStoriesBtn = document.getElementById('likedStoriesBtn');
            if (likedStoriesBtn) {
                likedStoriesBtn.addEventListener('click', showLikedStories);
            }
            
            // –ö–Ω–æ–ø–∫–∞ –≤—ã—Ö–æ–¥–∞
            const logoutButton = document.querySelector('.logout-button');
            if (logoutButton) {
                logoutButton.addEventListener('click', logout);
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ UI
        function initializeUI() {
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
            updateAuthUI();
            
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∏—Å—Ç–æ—Ä–∏–∏
            displayStories();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏ –æ–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–∏—Å–∫–∞
            const searchInput = document.getElementById('searchInput');
            if (searchInput && searchInput.value) {
                searchStories(searchInput.value);
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
            showMessage('success', '–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –∫ —Ä–∞–±–æ—Ç–µ');
        }

        // –§—É–Ω–∫—Ü–∏—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        function disableAppFunctionality() {
            const elements = {
                storyForm: document.querySelector('.story-form'),
                authButtons: document.querySelector('.auth-buttons'),
                storiesContainer: document.querySelector('.stories-container')
            };
            
            // –û—Ç–∫–ª—é—á–∞–µ–º —Ñ–æ—Ä–º—ã –∏ –∫–Ω–æ–ø–∫–∏
            if (elements.storyForm) {
                elements.storyForm.style.display = 'none';
            }
            
            if (elements.authButtons) {
                elements.authButtons.style.display = 'none';
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –∏—Å—Ç–æ—Ä–∏–π
            if (elements.storiesContainer) {
                elements.storiesContainer.innerHTML = `
                    <div class="error-message">
                        <h3>–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ</h3>
                        <p>–õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ:</p>
                        <ul>
                            <li>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º –±—Ä–∞—É–∑–µ—Ä–∞</li>
                            <li>–û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞</li>
                            <li>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π –±—Ä–∞—É–∑–µ—Ä</li>
                        </ul>
                    </div>
                `;
            }
        }

        // –û–±–Ω–æ–≤–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è UI
        function updateAuthUI() {
            try {
                const currentUser = getCurrentUser();
                const elements = {
                    // –≠–ª–µ–º–µ–Ω—Ç—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
                    authButtons: document.querySelector('.auth-buttons'),
                    authInfo: document.querySelector('.auth-info'),
                    authContainer: document.getElementById('authContainer'),
                    userName: document.getElementById('userName'),
                    
                    // –§–æ—Ä–º—ã
                    storyForm: document.querySelector('.story-form'),
                    newStoryForm: document.getElementById('newStoryForm'),
                    
                    // –ù–∞–≤–∏–≥–∞—Ü–∏—è
                    myStoriesBtn: document.getElementById('myStoriesBtn'),
                    likedStoriesBtn: document.getElementById('likedStoriesBtn'),
                    
                    // –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
                    storiesContainer: document.querySelector('.stories-container'),
                    searchContainer: document.querySelector('.search-container')
                };
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
                if (!elements.authButtons || !elements.authInfo) {
                    console.error('–ù–µ –Ω–∞–π–¥–µ–Ω—ã –æ—Å–Ω–æ–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞');
                    return;
                }
                
                if (currentUser) {
                    // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
                    // –≠–ª–µ–º–µ–Ω—Ç—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
                    elements.authButtons.style.display = 'none';
                    elements.authInfo.style.display = 'flex';
                    if (elements.authContainer) {
                        elements.authContainer.classList.remove('active');
                    }
                    
                    // –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                    if (elements.userName) {
                        elements.userName.textContent = currentUser.username;
                    }
                    
                    // –§–æ—Ä–º—ã
                    if (elements.storyForm) {
                        elements.storyForm.style.display = 'block';
                    }
                    if (elements.newStoryForm) {
                        elements.newStoryForm.style.display = 'block';
                    }
                    
                    // –ù–∞–≤–∏–≥–∞—Ü–∏—è
                    if (elements.myStoriesBtn) {
                        elements.myStoriesBtn.style.display = 'block';
                    }
                    if (elements.likedStoriesBtn) {
                        elements.likedStoriesBtn.style.display = 'block';
                    }
                    
                    // –ü–æ–∏—Å–∫
                    if (elements.searchContainer) {
                        elements.searchContainer.style.display = 'block';
                    }
                    
                } else {
                    // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
                    // –≠–ª–µ–º–µ–Ω—Ç—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
                    elements.authButtons.style.display = 'flex';
                    elements.authInfo.style.display = 'none';
                    
                    // –û—á–∏—â–∞–µ–º –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                    if (elements.userName) {
                        elements.userName.textContent = '';
                    }
                    
                    // –°–∫—Ä—ã–≤–∞–µ–º —Ñ–æ—Ä–º—ã
                    if (elements.storyForm) {
                        elements.storyForm.style.display = 'none';
                    }
                    if (elements.newStoryForm) {
                        elements.newStoryForm.style.display = 'none';
                    }
                    
                    // –°–∫—Ä—ã–≤–∞–µ–º –Ω–∞–≤–∏–≥–∞—Ü–∏—é
                    if (elements.myStoriesBtn) {
                        elements.myStoriesBtn.style.display = 'none';
                    }
                    if (elements.likedStoriesBtn) {
                        elements.likedStoriesBtn.style.display = 'none';
                    }
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–π
                displayStories();
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞:', error);
                showMessage('error', '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞');
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–∏–¥–∏–º–æ—Å—Ç–∏ —ç–ª–µ–º–µ–Ω—Ç–∞
        function toggleElement(element, show) {
            if (element) {
                element.style.display = show ? 'block' : 'none';
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞/—Å–∫—Ä—ã—Ç–∏—è —Ñ–æ—Ä–º—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        function toggleAuthForm(type) {
            const authContainer = document.getElementById('authContainer');
            const authForm = document.getElementById('authForm');
            const authTitle = document.querySelector('.auth-title');
            
            if (!authContainer || !authForm || !authTitle) {
                console.error('–ù–µ –Ω–∞–π–¥–µ–Ω—ã —ç–ª–µ–º–µ–Ω—Ç—ã —Ñ–æ—Ä–º—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏');
                return;
            }
            
            // –û—á–∏—â–∞–µ–º –æ—à–∏–±–∫–∏ –∏ —Ñ–æ—Ä–º—É
            clearErrors();
            authForm.reset();
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–∏–ø —Ñ–æ—Ä–º—ã
            authForm.dataset.type = type;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
            authTitle.textContent = type === 'register' ? '–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è' : '–í—Ö–æ–¥';
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É
            authContainer.classList.add('active');
        }

        // –§—É–Ω–∫—Ü–∏—è —Å–∫—Ä—ã—Ç–∏—è —Ñ–æ—Ä–º—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        function hideAuthForm() {
            const authContainer = document.getElementById('authContainer');
            if (authContainer) {
                authContainer.classList.remove('active');
            }
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –≤–Ω–µ —Ñ–æ—Ä–º—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        document.addEventListener('click', (e) => {
            const authContainer = document.getElementById('authContainer');
            if (authContainer && e.target === authContainer) {
                hideAuthForm();
            }
        });

        // –î–æ–±–∞–≤–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ–Ω—Ä–∞–≤–∏–≤—à–∏—Ö—Å—è –∏—Å—Ç–æ—Ä–∏–π
        function showLikedStories() {
            const currentUser = getCurrentUser();
            if (!currentUser) {
                showMessage('error', '–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É');
                return;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–æ–∫
            const allButtons = document.querySelectorAll('.nav-menu button');
            allButtons.forEach(btn => btn.classList.remove('active'));
            document.getElementById('likedStoriesBtn').classList.add('active');
            
            // –§–∏–ª—å—Ç—Ä—É–µ–º –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ç–æ–ª—å–∫–æ –ø–æ–Ω—Ä–∞–≤–∏–≤—à–∏–µ—Å—è –∏—Å—Ç–æ—Ä–∏–∏
            displayStories(story => story.likedBy && story.likedBy.includes(currentUser.username));
            
            const stories = document.querySelectorAll('.story-container');
            if (stories.length === 0) {
                document.querySelector('.stories-container').innerHTML = `
                    <div class="no-stories-message">
                        –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –ø–æ–Ω—Ä–∞–≤–∏–≤—à–∏—Ö—Å—è –∏—Å—Ç–æ—Ä–∏–π
                    </div>
                `;
            }
        }

        function togglePassword() {
            const passwordInput = document.getElementById('password');
            const toggleButton = document.querySelector('.toggle-password');
            
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                toggleButton.textContent = 'üëÅÔ∏è‚Äçüó®Ô∏è';
            } else {
                passwordInput.type = 'password';
                toggleButton.textContent = 'üëÅÔ∏è';
            }
        }

        // –û–±–Ω–æ–≤–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ª–∞–π–∫–æ–≤
        function handleLike(button, storyId) {
            try {
                const currentUser = getCurrentUser();
                if (!currentUser) {
                    showMessage('error', '–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É');
                    return;
                }
                
                const stories = getStoriesFromLocalStorage();
                const story = stories.find(s => s.id === storyId);
                
                if (!story) {
                    showMessage('error', '–ò—Å—Ç–æ—Ä–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
                    return;
                }
                
                if (!Array.isArray(story.likedBy)) {
                    story.likedBy = [];
                }
                
                const hasLiked = story.likedBy.includes(currentUser.username);
                
                if (hasLiked) {
                    story.likedBy = story.likedBy.filter(username => username !== currentUser.username);
                    story.likes = Math.max(0, (story.likes || 1) - 1);
                } else {
                    story.likedBy.push(currentUser.username);
                    story.likes = (story.likes || 0) + 1;
                }
                
                saveStoriesToLocalStorage(stories);
                displayStories();
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –ª–∞–π–∫–∞:', error);
                showMessage('error', '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –ª–∞–π–∫–∞');
            }
        }

        // –û–±–Ω–æ–≤–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function showMyStories() {
            const currentUser = getCurrentUser();
            if (!currentUser) {
                showMessage('error', '–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É');
                return;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–æ–∫
            const allButtons = document.querySelectorAll('.nav-menu button, .nav-menu a');
            allButtons.forEach(btn => btn.classList.remove('active'));
            document.getElementById('myStoriesBtn').classList.add('active');
            
            // –§–∏–ª—å—Ç—Ä—É–µ–º –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ç–æ–ª—å–∫–æ –∏—Å—Ç–æ—Ä–∏–∏ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            displayStories(story => story.authorName === currentUser.username);
            
            showMessage('success', '–ü–æ–∫–∞–∑–∞–Ω—ã –≤–∞—à–∏ –∏—Å—Ç–æ—Ä–∏–∏');
        }

        // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã
        document.getElementById('newStoryForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            clearErrors();
            
            const currentUser = getCurrentUser();
            if (!currentUser) {
                showMessage('error', '–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É');
                return;
            }
            
            const formData = new FormData(e.target);
            const storyData = Object.fromEntries(formData);
            
            const { isValid, errors } = validateStory(storyData);
            
            if (!isValid) {
                Object.keys(errors).forEach(key => {
                    showError(key, errors[key]);
                });
                return;
            }
            
            try {
                const newStory = {
                    id: Date.now().toString(),
                    title: storyData.storyTitle.trim(),
                    text: storyData.storyText.trim(),
                    authorName: currentUser.username,
                    date: new Date().toISOString(),
                    likes: 0,
                    likedBy: []
                };
                
                const stories = getStoriesFromLocalStorage();
                stories.unshift(newStory);
                saveStoriesToLocalStorage(stories);
                
                e.target.reset();
                displayStories();
                showMessage('success', '–ò—Å—Ç–æ—Ä–∏—è —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∞!');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∏—Å—Ç–æ—Ä–∏–∏:', error);
                showMessage('error', '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∏—Å—Ç–æ—Ä–∏–∏');
            }
        });

        function searchStories(query) {
            const stories = document.querySelectorAll('.story-container');
            const noResults = document.getElementById('noResults');
            let hasVisibleStories = false;
            
            stories.forEach(story => {
                const title = story.querySelector('.story-title').textContent.toLowerCase();
                const text = story.querySelector('.story-text').textContent.toLowerCase();
                const author = story.querySelector('.story-author')?.textContent.toLowerCase() || '';
                
                const searchQuery = query.toLowerCase();
                
                if (title.includes(searchQuery) || 
                    text.includes(searchQuery) || 
                    author.includes(searchQuery)) {
                    story.classList.remove('hidden');
                    hasVisibleStories = true;
                } else {
                    story.classList.add('hidden');
                }
            });
            
            noResults.style.display = hasVisibleStories ? 'none' : 'block';
        }

        // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏—è —Å debounce
        const searchInput = document.getElementById('searchInput');
        searchInput.addEventListener('input', debounce((e) => {
            searchStories(e.target.value);
        }, 300));

        // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –ø–æ–∏—Å–∫–∞
        searchInput.addEventListener('keyup', (e) => {
            if (e.key === 'Escape') {
                searchInput.value = '';
                searchStories('');
            }
        });

        // –û–±–Ω–æ–≤–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
        function handleRegistration(username, password) {
            const users = getUsers();
            
            if (users.some(u => u.username === username)) {
                showError('username', '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç');
                return;
            }
            
            if (password.length < 6) {
                showError('password', '–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤');
                return;
            }
            
            const newUser = { 
                username, 
                password,
                registrationDate: new Date().toISOString()
            };
            
            users.push(newUser);
            
            if (saveUsers(users)) {
                setCurrentUser(newUser);
                showMessage('success', '–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞!');
                const authContainer = document.getElementById('authContainer');
                if (authContainer) {
                    authContainer.classList.remove('active');
                }
                const authForm = document.getElementById('authForm');
                if (authForm) {
                    authForm.reset();
                }
                updateAuthUI();
            }
        }

        // –û–±–Ω–æ–≤–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ª–æ–≥–∏–Ω–∞
        function handleLogin(username, password) {
            const users = getUsers();
            const user = users.find(u => u.username === username && u.password === password);
            
            if (!user) {
                if (!users.some(u => u.username === username)) {
                    showError('username', '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º –Ω–µ –Ω–∞–π–¥–µ–Ω');
                } else {
                    showError('password', '–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å');
                }
                return;
            }
            
            if (setCurrentUser(user)) {
                showMessage('success', '–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ!');
                const authContainer = document.getElementById('authContainer');
                if (authContainer) {
                    authContainer.classList.remove('active');
                }
                const authForm = document.getElementById('authForm');
                if (authForm) {
                    authForm.reset();
                }
                updateAuthUI();
            }
        }

        // –û–±–Ω–æ–≤–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é –≤—ã—Ö–æ–¥–∞
        function logout() {
            try {
                localStorage.removeItem('currentUser');
                updateAuthUI();
                showMessage('success', '–í—ã —É—Å–ø–µ—à–Ω–æ –≤—ã—à–ª–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã');
                displayStories(); // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–π
                
                // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
                const authForm = document.getElementById('authForm');
                if (authForm) {
                    authForm.reset();
                }
                
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–æ–∏—Å–∫
                const searchInput = document.getElementById('searchInput');
                if (searchInput) {
                    searchInput.value = '';
                    searchStories('');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ:', error);
                showMessage('error', '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–∑ —Å–∏—Å—Ç–µ–º—ã');
            }
        }

        // –û–±–Ω–æ–≤–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∏—Å—Ç–æ—Ä–∏—è–º–∏
        function displayStories(filter = null) {
            try {
                const storiesContainer = document.querySelector('.stories-container');
                if (!storiesContainer) return;
                
                const stories = getStoriesFromLocalStorage();
                const currentUser = getCurrentUser();
                
                // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–∏–ª—å—Ç—Ä, –µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å
                const filteredStories = filter ? stories.filter(filter) : stories;
                
                if (filteredStories.length === 0) {
                    storiesContainer.innerHTML = `
                        <div class="no-stories-message">
                            ${filter ? '–ò—Å—Ç–æ—Ä–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω–æ' : '–ü–æ–∫–∞ –Ω–µ—Ç –Ω–∏ –æ–¥–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏'}
                        </div>
                    `;
                    return;
                }
                
                storiesContainer.innerHTML = filteredStories.map(story => {
                    const hasLiked = currentUser && story.likedBy && story.likedBy.includes(currentUser.username);
                    const isAuthor = currentUser && story.authorName === currentUser.username;
                    
                    return `
                        <div class="story-container" data-id="${story.id}">
                            <h3 class="story-title">${escapeHtml(story.title)}</h3>
                            <p class="story-text">${escapeHtml(story.text)}</p>
                            <div class="story-meta">
                                <span class="story-author">–ê–≤—Ç–æ—Ä: ${escapeHtml(story.authorName)}</span>
                                <span class="story-date">${formatDate(story.date)}</span>
                            </div>
                            <div class="story-actions">
                                ${currentUser ? `
                                    <button 
                                        class="like-button ${hasLiked ? 'liked' : ''}"
                                        onclick="handleLike(this, '${story.id}')"
                                    >
                                        ${hasLiked ? '‚ù§Ô∏è' : 'ü§ç'} ${story.likes || 0}
                                    </button>
                                    ${isAuthor ? `
                                        <button 
                                            class="delete-button"
                                            onclick="deleteStory('${story.id}')"
                                        >
                                            üóëÔ∏è
                                        </button>
                                    ` : ''}
                                ` : ''}
                            </div>
                        </div>
                    `;
                }).join('');
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –∏—Å—Ç–æ—Ä–∏–π:', error);
                showMessage('error', '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏ –∏—Å—Ç–æ—Ä–∏–π');
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–π –∏—Å—Ç–æ—Ä–∏–∏
        function handleStorySubmit(e) {
            e.preventDefault();
            clearErrors();
            
            const currentUser = getCurrentUser();
            if (!currentUser) {
                showMessage('error', '–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É');
                return;
            }
            
            const formData = new FormData(e.target);
            const storyData = Object.fromEntries(formData);
            
            // –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
            if (!storyData.title.trim() || !storyData.text.trim()) {
                showMessage('error', '–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }
            
            try {
                const newStory = {
                    id: Date.now().toString(),
                    title: storyData.storyTitle.trim(),
                    text: storyData.storyText.trim(),
                    authorName: currentUser.username,
                    date: new Date().toISOString(),
                    likes: 0,
                    likedBy: []
                };
                
                const stories = getStoriesFromLocalStorage();
                stories.unshift(newStory);
                saveStoriesToLocalStorage(stories);
                
                e.target.reset();
                displayStories();
                showMessage('success', '–ò—Å—Ç–æ—Ä–∏—è —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∞!');
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∏—Å—Ç–æ—Ä–∏–∏:', error);
                showMessage('error', '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∏—Å—Ç–æ—Ä–∏–∏');
            }
        }

        // –§—É–Ω–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏
        function deleteStory(storyId) {
            try {
                const currentUser = getCurrentUser();
                if (!currentUser) {
                    showMessage('error', '–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É');
                    return;
                }
                
                const stories = getStoriesFromLocalStorage();
                const storyIndex = stories.findIndex(s => s.id === storyId);
                
                if (storyIndex === -1) {
                    showMessage('error', '–ò—Å—Ç–æ—Ä–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
                    return;
                }
                
                if (stories[storyIndex].authorName !== currentUser.username) {
                    showMessage('error', '–í—ã –º–æ–∂–µ—Ç–µ —É–¥–∞–ª—è—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –∏—Å—Ç–æ—Ä–∏–∏');
                    return;
                }
                
                if (confirm('–í—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É –∏—Å—Ç–æ—Ä–∏—é?')) {
                    stories.splice(storyIndex, 1);
                    saveStoriesToLocalStorage(stories);
                    displayStories();
                    showMessage('success', '–ò—Å—Ç–æ—Ä–∏—è —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω–∞');
                }
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∏—Å—Ç–æ—Ä–∏–∏:', error);
                showMessage('error', '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∏—Å—Ç–æ—Ä–∏–∏');
            }
        }

        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function formatDate(dateString) {
            return new Date(dateString).toLocaleString('ru-RU', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        // –§—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ API
        function handleApiError(error, defaultMessage = '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞') {
            console.error('API Error:', error);
            
            let message = defaultMessage;
            if (error.message) {
                message = error.message;
            }
            
            showMessage('error', message);
        }

        // –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
        function validateAndRepairData() {
            try {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º–∞—Å—Å–∏–≤ –∏—Å—Ç–æ—Ä–∏–π
                let stories = getStoriesFromLocalStorage();
                if (!Array.isArray(stories)) {
                    console.warn('–ü–æ–≤—Ä–µ–∂–¥–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏–π, –≤—ã–ø–æ–ª–Ω—è–µ–º —Å–±—Ä–æ—Å');
                    stories = [];
                    saveStoriesToLocalStorage(stories);
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º–∞—Å—Å–∏–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
                let users = getUsers();
                if (!Array.isArray(users)) {
                    console.warn('–ü–æ–≤—Ä–µ–∂–¥–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –≤—ã–ø–æ–ª–Ω—è–µ–º —Å–±—Ä–æ—Å');
                    users = [];
                    saveUsers(users);
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                const currentUser = getCurrentUser();
                if (currentUser && !users.some(u => u.username === currentUser.username)) {
                    console.warn('–°–µ—Å—Å–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞, –≤—ã–ø–æ–ª–Ω—è–µ–º –≤—ã—Ö–æ–¥');
                    logout();
                }
                
                return true;
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –¥–∞–Ω–Ω—ã—Ö:', error);
                showMessage('error', '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è');
                return false;
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –æ—à–∏–±–æ–∫
        function logError(error, context = '') {
            const errorLog = {
                timestamp: new Date().toISOString(),
                message: error.message,
                stack: error.stack,
                context: context
            };
            
            console.error('Logged Error:', errorLog);
            
            try {
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ª–æ–≥ –æ—à–∏–±–∫–∏
                const errorLogs = JSON.parse(localStorage.getItem('errorLogs') || '[]');
                errorLogs.push(errorLog);
                // –•—Ä–∞–Ω–∏–º —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 50 –æ—à–∏–±–æ–∫
                if (errorLogs.length > 50) {
                    errorLogs.shift();
                }
                localStorage.setItem('errorLogs', JSON.stringify(errorLogs));
            } catch (e) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –ª–æ–≥–∞ –æ—à–∏–±–æ–∫:', e);
            }
        }

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫
        window.onerror = function(message, source, lineno, colno, error) {
            logError(error || new Error(message), 'Global Error Handler');
            return false;
        };

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –ø—Ä–æ–º–∏—Å–æ–≤
        window.addEventListener('unhandledrejection', function(event) {
            logError(event.reason, 'Unhandled Promise Rejection');
        });
    </script>
</body>
</html> 
